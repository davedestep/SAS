data dta01; INPUT SUBJ SEQ PERIOD DRUG REPL CMAX AUCT AUCINF ;
cards;
1    1    1    1    1    135.0     2194.6    2259.17
2    2    4    1    2    113.0     1038.73   1143.25
3    4    3    1    2    111.0     1213.00   1278.08
5    2    4    1    2    150.0     2525.43   2898.41
6    1    1    1    1    83.90     865.43    1144.60
7    3    2    1    1    108.0     1164.36   1239.18
8    4    3    1    2    73.10     660.75    703.02
9    4    3    1    2    37.30     569.33    763.30
10   3    2    1    1    349.0     2919.61   3030.59
11   2    4    1    2    52.10     582.22    674.18
12   1    1    1    1    120.0     1037.14   1098.31
13   1    1    1    1    38.10     775.52    1049.15
14   2    4    1    2    102.0     885.21    1144.47
15   4    3    1    2    108.0     877.45    982.47
16   3    2    1    1    43.30     919.45    1134.72
17   1    1    1    1    103.0     2048.9    .
20   4    3    1    2    .         .         .
21   4    3    1    2    66.20     464.11    528.98
22   3    2    1    1    133.0     1020.85   1184.53
23   2    4    1    2    20.70     305.87    .
24   1    1    1    1    100.0     1068.27   1203.59
25   2    4    1    2    78.30     2031.97   2124.94
26   1    1    1    1    49.40     897.80    1027.45
27   3    2    1    1    142.0     1196.63   1397.46
28   4    3    1    2    97.50     1138.85   1228.17
1    1    3    1    2    68.80     1478.33   1613.09
2    2    1    1    1    111.0     1131.28   1194.96
3    4    2    1    1    247.0     1632.98   1723.13
5    2    1    1    1    125.0     2282.23   2563.82
6    1    3    1    2    51.30     1266.15   .
7    3    4    1    2    124.0     992.0     1114.25
8    4    2    1    1    50.60     355.13    402.05
9    4    2    1    1    42.70     554.83    817.25
10   3    4    1    2    286.0     3221.0    3379.61
11   2    1    1    1    56.20     553.16    652.78
12   1    3    1    2    121.0     1016.41   1099.57
13   1    3    1    2    76.70     900.15    1242.31
14   2    1    1    1    47.50     697.50    1750.56
15   4    2    1    1    57.00     610.22    726.15
16   3    4    1    2    36.30     743.05    1116.96
17   1    3    1    2    87.00     1109.53   .
20   4    2    1    1    83.50     1153.58   2233.71
21   4    2    1    1    112.0     566.22    604.34
22   3    4    1    2    228.0     1349.15   1554.16
23   2    1    1    1    75.80     548.64    612.97
24   1    3    1    2    226.0     1843.11   1895.79
25   2    1    1    1    242.0     3401.0    3495.90
26   1    3    1    2    108.0     905.60    977.03
27   3    4    1    2    182.0     1516.29   1582.60
28   4    2    1    1    35.60     841.48    981.71
1    1    2    2    1    62.70     976.87    1093.57
2    2    3    2    2    99.70     1007.60   1100.48
3    4    4    2    2    128.0     1098.58   1174.05
5    2    3    2    2    222.0     2822.96   2924.07
6    1    2    2    1    191.0     1303.33   1383.17
7    3    1    2    1    147.0     1478.15   1581.18
8    4    4    2    2    49.40     525.72    574.36
9    4    4    2    2    71.80     503.70    547.45
10   3    1    2    1    445.0     2491.44   2581.36
11   2    3    2    2    61.90     526.61    591.28
12   1    2    2    1    126.0     1027.63   1114.23
13   1    2    2    1    66.60     819.95    983.89
14   2    3    2    2    121.0     1691.56   1772.25
15   4    4    2    2    71.40     735.45    868.92
16   3    1    2    1    31.60     653.82    922.92
17   1    2    2    1    95.90     2266.53   2331.91
20   4    4    2    2    .         .         .
21   4    4    2    2    114.0     607.81    642.09
22   3    1    2    1    134.0     1089.31   1294.44
23   2    3    2    2    223.0     1164.57   1213.66
24   1    2    2    1    68.90     1294.22   1348.28
25   2    3    2    2    271.0     2161.10   2261.51
26   1    2    2    1    101.0     875.94    982.97
27   3    1    2    1    309.0     1825.60   1901.51
28   4    4    2    2    96.90     1062.46   1129.17
1    1    4    2    2    144.0     2052.72   2119.83
2    2    2    2    1    112.0     879.40    952.72
3    4    1    2    1    88.50     1130.78   1175.88
5    2    2    2    1    146.0     2534.83   2670.03
6    1    4    2    2    43.80     980.31    .
7    3    3    2    2    143.0     1070.43   1262.65
8    4    1    2    1    34.10     417.03    985.61
9    4    1    2    1    44.80     562.61    737.77
10   3    3    2    2    331.0     3069.13   3186.74
11   2    2    2    1    41.10     435.48    501.31
12   1    4    2    2    95.80     910.18    993.46
13   1    4    2    2    31.70     579.48    1406.66
14   2    2    2    1    63.60     772.59    1237.15
15   4    1    2    1    41.20     441.05    540.58
16   3    3    2    2    35.20     721.24    1096.44
17   1    4    2    2    73.00     1724.79   1807.58
20   4    1    2    1    125.0     2100.41   .
21   4    1    2    1    85.10     539.03    576.69
22   3    3    2    2    32.90     252.65    398.53
23   2    2    2    1    126.0     1039.93   1134.28
24   1    4    2    2    130.0     1712.04   1775.59
25   2    2    2    1    96.40     2344.80   2426.03
26   1    4    2    2    144.0     1105.30   1195.52
27   3    3    2    2    85.70     1047.60   1228.97
28   4    1    2    1    21.30     293.49    618.23
;

proc sort; by subj drug period ;
data dta02; set dta01; by subj drug period; if first.drug ;
     keep subj repl drug period seq cmax auct aucinf lauct laucinf lcmax ;
     if repl=1 ; lauct=log(auct); laucinf=log(aucinf); lcmax=log(cmax) ;

proc print data=dta02;
run;


proc means data=dta02;
CLASS DRUG;  
VAR AUCT AUCINF CMAX/*/ WEIGHT=weight-variable>*/; 
run;

proc means data=dta02;
CLASS DRUG;  
VAR LAUCT LAUCINF LCMAX; 
run;

PROC GLM data=dta02;
CLASS SUBJ SEQ PERIOD DRUG;
MODEL LAUCT = SEQ SUBJ(SEQ) DRUG PERIOD / SS3 ;
TEST H=SEQ E=SUBJ(SEQ);
MEANS DRUG / T CLDIFF ALPHA=0.1 ;
RUN;

PROC GLM data=dta02;
CLASS SUBJ SEQ PERIOD DRUG;
MODEL LAUCINF = SEQ SUBJ(SEQ) DRUG PERIOD / SS3 ;
TEST H=SEQ E=SUBJ(SEQ);
MEANS DRUG / T CLDIFF ALPHA=0.1 ;
RUN;


PROC GLM data=dta02;
CLASS SUBJ SEQ PERIOD DRUG;
MODEL LCMAX = SEQ SUBJ(SEQ) DRUG PERIOD / SS3 ;
TEST H=SEQ E=SUBJ(SEQ);
MEANS DRUG / T CLDIFF ALPHA=0.1 ;
RUN;






/*HW2*/
data dta41;
input Obs    CTR    PID    TRT    SEX $   AGE    RESP;
cards;
  1    501      1     2      M      46      0
  2    501      2     1      M      64      1
  3    501      3     3      M      43      1
  4    501      4     0      F      48      1
  5    501      5     2      M      49      0
  6    501      6     0      M      56      0
  7    501      7     3      F      53      0
  8    501      8     1      M      58      0
  9    501      9     1      F      70      0
 10    501     10     0      M      53      0
 11    501     11     2      F      54      1
 12    501     12     3      M      61      1
 13    501     13     0      F      44      0
 14    501     14     2      F      65      1
 15    501     15     1      M      44      1
 16    501     16     3      M      55      1
 17    501     17     2      F      67      1
 18    501     18     3      M      48      0
 19    501     19     1      F      58      0
 20    501     20     0      M      61      0
 21    501     21     2      M      73      0
 22    502      1     1      M      41      0
 23    502      2     2      M      62      1
 24    502      3     3      M      47      0
 25    502      4     0      F      48      0
 26    502      5     3      M      65      0
 27    502      6     2      F      60      0
 28    502      7     1      F      38      0
 29    502      8     0      F      51      0
 30    502      9     3      M      46      0
 31    502     10     1      M      47      0
 32    502     11     2      F      51      1
 33    502     12     0      M      40      0
 34    502     13     1      M      54      1
 35    502     14     2      M      68      0
 36    502     15     3      F      28      1
 37    502     16     0      F      59      0
 38    502     17     2      F      50      0
 39    502     18     3      F      75      0
 40    502     19     0      F      57      1
 41    502     20     1      M      62      1
 42    502     21     1      F      60      0
 43    502     22     3      M      64      1
 44    502     23     2      M      57      0
 45    502     24     0      F      47      1
 46    502     25     1      F      66      0
 47    502     26     3      M      55      0
 48    502     27     2      F      42      1
 49    502     28     0      F      55      0
 50    502     29     2      M      44      0
 51    502     30     0      F      44      0
 52    502     31     1      F      56      1
 53    502     32     3      M      58      0
 54    502     33     1      M      58      1
 55    502     34     0      F      44      0
 56    502     35     3      M      54      0
 57    503      1     0      M      50      0
 58    503      2     1      F      74      0
 59    503      3     2      F      55      1
 60    503      4     3      M      55      0
 61    503      5     1      F      51      0
 62    503      6     3      F      39      1
 63    503      7     0      F      59      0
 64    503      8     2      M      57      0
 65    503      9     1      F      59      0
 66    503     10     2      F      52      0
 67    503     11     0      F      54      0
 68    503     12     3      M      55      0
 69    503     13     3      F      70      0
 70    503     14     1      M      78      0
 71    503     15     2      M      52      1
 72    503     16     0      F      66      0
 73    503     17     1      M      37      0
 74    503     18     3      M      41      1
 75    503     19     2      F      51      0
 76    503     20     0      M      58      0
 77    503     21     3      M      55      1
 78    503     22     0      F      65      1
 79    504      1     2      M      49      1
 80    504      2     1      F      35      1
 81    504      3     3      F      53      1
 82    504      4     0      F      43      0
 83    504      5     2      M      37      0
 84    504      6     1      F      44      0
 85    504      7     3      M      61      1
 86    504      8     0      F      60      1
 87    504      9     0      F      53      0
 88    504     10     2      M      55      0
 89    504     11     3      F      43      1
 90    504     12     1      M      58      1
 91    504     13     1      M      55      0
 92    504     14     0      F      54      0
 93    504     15     3      M      45      0
 94    504     16     2      F      54      1
 95    504     17     1      F      50      0
 96    504     18     0      M      60      0
 97    504     19     2      F      47      1
 98    504     20     3      F      64      0
 99    504     21     2      F      57      0
100    504     22     0      M      50      0
101    504     23     1      M      48      0
102    504     24     3      M      54      1
103    504     25     3      M      72      0
104    504     26     0      F      80      0
105    504     27     1      F      57      1
106    504     28     2      M      58      0
107    504     29     3      M      50      1
108    504     30     2      M      49      1
109    504     31     1      F      59      0
110    504     32     0      F      69      1
111    504     33     0      M      56      1
112    504     34     2      M      73      1
113    505      1     0      F      57      0
114    505      2     3      M      49      0
115    505      3     1      F      60      1
116    505      4     2      F      54      0
117    505      5     1      F      54      0
118    505      6     3      F      79      1
119    505      7     2      F      32      1
120    505      8     0      M      41      0
121    505      9     1      M      61      0
122    505     10     2      M      47      0
123    505     11     0      M      57      0
124    505     12     3      M      44      1
125    505     13     1      F      67      0
126    505     14     3      F      51      1
127    505     15     0      F      56      0
128    505     16     2      M      53      1
129    505     17     1      M      56      1
130    505     18     0      M      61      1
131    505     19     2      F      71      0
132    505     20     3      F      48      0
133    505     21     1      F      40      1
134    505     22     0      M      59      0
135    505     23     3      F      35      1
136    506      1     0      F      74      0
137    506      2     2      F      66      1
138    506      3     3      F      74      0
139    506      4     1      M      52      0
140    506      5     3      F      50      1
141    506      6     0      M      46      0
142    506      7     1      M      53      0
143    506      8     2      F      51      0
144    506      9     3      F      54      0
145    506     10     2      F      73      0
146    506     11     0      M      56      0
147    506     12     1      M      54      0
148    506     13     3      M      57      1
149    506     14     2      F      33      0
150    506     15     0      M      34      0
151    506     16     1      F      61      1
152    507      1     1      F      49      1
153    507      2     0      F      58      0
154    507      3     3      M      53      0
155    507      4     2      M      52      1
156    507      5     0      F      63      0
157    507      6     1      F      60      0
158    507      7     2      F      70      0
159    507      8     3      M      53      1
160    507      9     0      M      60      0
161    507     10     3      F      31      1
162    507     11     2      M      38      0
163    507     12     1      F      60      1
164    507     13     1      F      47      0
165    507     14     0      M      59      0
166    507     15     3      M      69      0
167    507     16     2      M      61      0
168    507     17     3      F      49      0
169    507     18     2      F      66      1
170    507     19     1      F      72      1
171    507     20     0      F      69      0
172    507     21     1      F      56      1
173    507     22     2      F      43      0
174    508      1     1      F      48      0
175    508      2     3      F      38      1
176    508      3     0      M      47      0
177    508      4     2      F      66      1
178    508      5     2      F      29      0
179    508      6     0      M      58      0
180    508      7     1      M      58      1
181    508      8     3      F      50      0
182    508      9     3      F      47      1
183    508     10     2      F      56      0
184    508     11     0      F      69      0
185    508     12     1      F      44      0
186    508     13     2      F      52      1
187    508     14     3      M      65      1
188    508     15     0      F      41      1
189    508     16     1      F      46      1
190    508     17     2      F      46      0
191    508     18     1      M      73      0
192    508     19     0      F      56      0
193    508     20     3      F      41      1
194    508     21     3      M      59      1
195    508     22     1      F      45      0
196    508     23     2      F      67      1
197    508     24     0      F      71      0
198    508     25     1      F      49      1
199    508     26     0      M      62      1
200    509      1     1      M      43      0
201    509      2     3      F      61      1
202    509      3     0      F      48      0
203    509      4     2      F      58      1
204    509      5     1      F      53      1
205    509      6     0      M      52      0
206    509      7     2      M      54      1
207    509      8     3      M      63      1
208    509      9     0      F      55      0
209    509     10     1      M      52      0
210    509     11     2      F      52      1
211    509     12     3      F      58      0
212    509     13     0      F      53      0
213    509     14     2      F      54      0
214    509     15     3      M      67      0
215    509     16     1      M      57      0
216    509     17     2      F      49      0
217    509     18     0      F      46      1
;
proc sort data=dta41; by descending trt descending resp;
run;

proc freq data=dta41 order=data; tables trt*resp/cmh; where trt in (0,1) ;
proc freq data=dta41 order=data; tables trt*resp/cmh; where trt in (0,2) ;
proc freq data=dta41 order=data; tables trt*resp/cmh; where trt in (0,3) ;


proc freq data=dta41 order=data; title "Low Dose";
	table trt*resp/ relrisk chisq expected;  where trt in (0,1) ;
run;
proc freq data=dta41 order=data; title "Medium Dose";
	table trt*resp/ relrisk chisq expected;  where trt in (0,2) ;
run;
proc freq data=dta41 order=data; title "High Dose";
	table trt*resp/ relrisk chisq expected;  where trt in (0,3) ;
run;


/*tend test*/
proc freq order=data data=dta41; tables trt*resp/cmh ;
run;

/*Breslow day test*/
proc freq data=dta41 order=data; title "Low Dose"; tables sex*trt*resp/cmh; where trt in (0,1) ; run;
proc freq data=dta41 order=data; title "Medium Dose"; tables sex*trt*resp/cmh; where trt in (0,2) ; run;
proc freq data=dta41 order=data; title "High Dose"; tables sex*trt*resp/cmh; where trt in (0,3) ; run;

